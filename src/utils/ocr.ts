export type Letter =
  | "A"
  | "B"
  | "C"
  | "D"
  | "E"
  | "F"
  | "G"
  | "H"
  | "I"
  | "J"
  | "K"
  | "L"
  | "M"
  | "N"
  | "O"
  | "P"
  | "Q"
  | "R"
  | "S"
  | "T"
  | "U"
  | "V"
  | "W"
  | "X"
  | "Y"
  | "Z"

const LETTERS_W8_H10: Record<string, Letter> = {
  "######..#.......#.......#.......#####...#.......#.......#.......#.......######..": "E",
  "#....#..#...#...#..#....#.#.....##......##......#.#.....#..#....#...#...#....#..": "K",
  "#.......#.......#.......#.......#.......#.......#.......#.......#.......######..": "L",
  "#....#..##...#..##...#..#.#..#..#.#..#..#..#.#..#..#.#..#...##..#...##..#....#..": "N",
  "#####...#....#..#....#..#....#..#####...#.......#.......#.......#.......#.......": "P",
  "#####...#....#..#....#..#....#..#####...#..#....#...#...#...#...#....#..#....#..": "R",
  "#....#..#....#...#..#....#..#.....##......##.....#..#....#..#...#....#..#....#..": "X",
}

const LETTERS_W5_H6: Record<string, Letter> = {
  ".##..#..#.#..#.####.#..#.#..#.": "A",
  "###..#..#.###..#..#.#..#.###..": "B",
  ".##..#..#.#....#....#..#..##..": "C",
  "####.#....###..#....#....####.": "E",
  "####.#....###..#....#....#....": "F",
  ".##..#..#.#....#.##.#..#..###.": "G",
  "#..#.#..#.####.#..#.#..#.#..#.": "H",
  "..##....#....#....#.#..#..##..": "J",
  "#..#.#.#..##...#.#..#.#..#..#.": "K",
  "#....#....#....#....#....####.": "L",
  ".##..#..#.#..#.#..#.#..#..##..": "O",
  "###..#..#.#..#.###..#....#....": "P",
  "###..#..#.#..#.###..#.#..#..#.": "R",
  ".###.#....#.....##.....#.###..": "S",
  "#..#.#..#.#..#.#..#.#..#..##..": "U",
  "#...##...#.#.#...#....#....#..": "Y",
  "####....#...#...#...#....####.": "Z",
}

const dictionaries = {
  "8x10": LETTERS_W8_H10,
  "5x6": LETTERS_W5_H6,
}

export function recognizeWord(letters: string[][]) {
  const word = []
  for (const letter of letters) {
    const width = letter[0].length
    const height = letter.length
    const dictionary = dictionaries[`${width}x${height}` as keyof typeof dictionaries]
    if (!dictionary) {
      throw new Error(`Unknown dictionary for width ${width} and height ${height}`)
    }
    const key = letter.join("") as keyof typeof dictionary
    if (dictionary[key]) {
      word.push(dictionary[key])
    } else {
      console.log(letter.join("\n"))
      throw new Error(`Unknown letter: "${key}"`)
    }
  }
  return word.join("")
}
